\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{mathutils}[2020-10-03 Basic math utilities]

\RequirePackage{amsmath,amsthm,amsfonts,amssymb,amscd}
\RequirePackage{mathtools}
\RequirePackage{dsfont}
\RequirePackage{amsthm,etoolbox}
\RequirePackage[dvipsnames]{xcolor}

\makeatletter
\newcommand{\ScaleDeclarePairedDelimiter}[3]{%
  \expandafter\DeclarePairedDelimiter\csname RIGHT\string#1\endcsname{#2}{#3}%
  \newcommand#1{%
    \@ifstar{\csname RIGHT\string#1\endcsname}
            {\@ifnextchar[{\csname RIGHT\string#1\endcsname}
                          {\csname RIGHT\string#1\endcsname*}%
            }%
  }%
}
\makeatother

% Probability
\renewcommand{\Pr}{\operatorname*{\mathbb{P}}}
\newcommand{\Var}{\operatorname*{\mathrm{Var}}}
\newcommand{\Bias}{\operatorname*{\mathrm{Bias}}}
\newcommand{\MSE}{\operatorname*{\mathrm{MSE}}}
\newcommand{\Cov}{\operatorname*{\mathrm{Cov}}}
\newcommand{\Exp}{\operatorname*{\mathbb{E}}}
\newcommand{\from}{\leftarrow}
\newcommand{\negl}{\mathrm{negl}}

% Asymptotics
\newcommand{\poly}{\operatorname*{\mathrm{poly}}}
\newcommand{\polylog}{\operatorname*{\mathrm{polylog}}}

% Distributions
\newcommand{\Normal}{\mathcal{N}}
\newcommand{\Bin}{\mathrm{Binomial}}
\newcommand{\Poi}{\mathrm{Poisson}}
\newcommand{\Unif}{\mathrm{Unif}}
\newcommand{\Bernoulli}{\mathrm{Bernoulli}}
\newcommand{\Geom}{\mathrm{Geom}}
\newcommand{\DistD}{\mathcal{D}}
\newcommand{\DistG}{\mathcal{G}}
\newcommand{\DTV}{d_\mathrm{TV}}
\newcommand{\DKL}{D_\mathrm{KL}}
\renewcommand{\DH}{d_\mathrm{H}}

% Sets/rings/groups/fields and other mathematical constructs
\newcommand{\PSet}{\mathcal{P}}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Complex}{\mathbb{C}}
\newcommand{\Rational}{\mathbb{Q}}
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\Int}{\mathbb{Z}}
\newcommand{\Fin}[1]{\mathbb{F}_{#1}}
\newcommand{\argmax}{\operatorname*{\mathrm{arg\,max}}}
\newcommand{\argmin}{\operatorname*{\mathrm{arg\,min}}}
\renewcommand{\implies}{\Rightarrow}
\newcommand{\2}{\{0, 1\}}
\newcommand{\1}{\mathbbm{1}}

% Calculus/Analysis
\renewcommand{\d}{\mathrm{d}}
\newcommand{\Diff}[2][]{\frac{\d#1}{\d#2}}
\newcommand{\Grad}{\nabla}
\newcommand{\Del}[2][]{\frac{\partial#1}{\partial#2}}

% Linear algebra
\newcommand{\tr}{\mathrm{tr}}
\DeclareMathOperator{\rng}{range}
\ScaleDeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\newcommand{\sprod}[2]{\left\langle#1, #2\right\rangle}
\newcommand{\Span}{\mathrm{Span}}

% Analysis
\newcommand{\boundary}[1]{\text{bd } #1}
\newcommand{\closure}[1]{\text{cl } #1}
\newcommand{\interior}[1]{\text{int } #1}
\newcommand{\Alg}{\mathcal{A}}
\newcommand{\SigAlg}{\mathcal{M}}

% Algebra
\newcommand{\Cyc}{\mathcal{C}}
\newcommand{\Dih}{\mathcal{D}}
\newcommand{\Sym}{\mathcal{S}}
\newcommand{\Quat}{\mathcal{Q}}


% Miscellaneous
\newcommand{\eps}{\epsilon}
\DeclareMathOperator{\sgn}{sgn}
\newcommand{\divs}{\;|\;}
\newcommand{\ind}{\mathds{1}}
\ScaleDeclarePairedDelimiter\abs{\lvert}{\rvert}
\ScaleDeclarePairedDelimiter\size{\lvert}{\rvert}
\ScaleDeclarePairedDelimiter\br{[}{]}
\ScaleDeclarePairedDelimiter\p{(}{)}
\ScaleDeclarePairedDelimiter\set{\{}{\}}
\ScaleDeclarePairedDelimiter\ceil{\lceil}{\rceil}
\ScaleDeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\newcommand{\setof}[2]{\set{#1\; | \; #2}}

\newcommand{\Seq}[2][\infty]{\set{#2}_1^{#1}}

\newcounter{nTheorems}

\newtheorem{theorem}[nTheorems]{Theorem}
\newtheorem{corollary}[nTheorems]{Corollary}
\newtheorem{conjecture}[nTheorems]{Conjecture}
\newtheorem{lemma}[nTheorems]{Lemma}
\newtheorem{proposition}[nTheorems]{Proposition}
\newtheorem{protocol}[nTheorems]{Protocol}
\newtheorem{claim}[nTheorems]{Claim}
\newtheorem{fact}[nTheorems]{Fact}

\newenvironment{asciicdot}
 {\mathcode`*=\cdot\ignorespaces}
 {\ignorespacesafterend}

\newenvironment{asciiangle}
 {%
  \mathcode`<="8000
  \mathcode`>="8000
  \begingroup\lccode`~=`< \lowercase{\endgroup\let~}\langle
  \begingroup\lccode`~=`> \lowercase{\endgroup\let~}\rangle
  \ignorespaces}
 {\ignorespacesafterend}

\patchcmd{\endproof}% <cmd>
  {\endtrivlist}% <search>
  {\endtrivlist\par\nobreak\vspace*{\dimexpr-\baselineskip-\parskip}\nobreak\noindent\hrulefill}% <replace>
  {}{}% <succes><failure>

  \newcommand{\TODO}{\textbf{\Huge \color{Red} TODO}}
